name: Design Token Workflow

on:
  pull_request:
    branches: 
    - master

jobs:
  Design-Token-Workflow:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v1
      with:
        node-version: '14.x'

    - name: Install dependencies
      run: npm install

    - name: Run transform
      run: npm run transform

    - name: Build tokens
      run: npm run build-tokens

    - name: Commit changes
      run: |
        git config --global user.email "tanishraj91@gmail.com"
        git config --global user.name "tanishraj"
        git add .
        git commit -m "Design tokens changes"
        git checkout origin/master
        git pull origin master
    
    - name: Push changes
      uses: ad-m/github-push-action@master
      with:
        github_token: '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'
        branch: 'master'

    - name: Merge to master
      uses: pascalgn/automerge-action@v0.13.1
      with:
        GITHUB_TOKEN: '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'
        
    - name: Log
      run: echo "Completed successfully."
